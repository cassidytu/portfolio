<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page!</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.1), 0 5px 5px 0 rgba(0, 0, 0, 0.1);
                border-radius: 10px;
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
                
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #724993;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
                border-radius: 10px;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #724993;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #F7F6F3;
                font-family: Manrope;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page!</p>
                        <p><p>Please enter the codeword.</p>
</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Codeword"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="template_toggle_show"
                                title="template_toggle_show"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="UNLOCK" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = 
            ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        ;
            const templateError = "template_error",
                templateToggleAltShow = "template_toggle_show",
                templateToggleAltHide = "template_toggle_hide",
                isRememberEnabled = false,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0ae9526e46fd808405a240234e38566051d9076b3427fcad0d5c0c69848148fae50c61b8417c951f74b0f6d50e8789bad1c0b7e32855b164eea8fab626bed27639d014ff969cc7081efcda0170220b8cb87f24338049f012482a27aabce894df4beb5ecd8c1d39bddaf66c78ceb8ec0aae8c45bf6e974e47a529a853dfa94abaa0c0ead42249685fd7329392faca1ab2c32e8665f798a43181985372025a6180b50922920f02fe388e07a4cf47eef0e1b699d02199b494b6ec0cbdc28a23d57816ecd29907a964f09144bfc34b558e98e2d5d25ced9644196ef0ae9f3a4ebbef819a889f5f6e7eadf28e601d3239e53c4f201d28eebd8914daa395817b16027601588cfd4bcbceea4f78bb7c761624dd265fd2bb056107776fe6a4fe17f72c1ebcf4385f8a62f8b313de7ed6b9a1fb6653228937997228cdeb415048209ec00b29195f0a906bd469dff94fe9c6ffa9ec864824096fe03b6c479d447b09a4ebf4590bc0b2927afba4b9ab2afc05ccfd426dc2cc53b000e2cba96ab95a73a42d8659b407c68a2164fee02bc926636e462a6f6367822f5a435513d8a930ff403d3378181a0fe68599b4f6ccf0d82f590cd79b5ef7049288d6be7fee03387bab22a2e9d35096ca17c64de956ef7498487e1fc5a560d0fd2830ba249c6626b5aae5c636b5dfeb1bd125b2d003bec04ec2bb090cb27780d8080b884fed93a466e1b5b952f5d81c3d9a9e8c8a2c901ddb357344aa6259ab27a1178f86e5ab005a7d30c24412d8362174dd8ff1b1c2f8d7e1d8e48bc3abdb663b7b635fe8829dadf5f99f2c261aa5e9681bb64e2448d5b71f272eecd8196ce1c4f942fea26289e68e95ad253eeaaf7f54a27478c4961ea035e6faee1dfcf0c7026a54dbc4119c74d4c9107c607060a532f1c78a7ffd58ab5b4dc182ae1f98e7b4de858d187a00f8b9c3aa8d5d4e309800e6a1bce222aa66035577f5c9f1d50b700cf6c8a3f95be56ae8d46906d3a57f5ac4c7376cf7be675b599f7c64a55424cc85313420ebc7a1f264c4b4eeb2e55e2520a6bdacf8813af39e7e5903ba654ab5fa401526ca2b4efd91a48e25e0b4d2115cb975aa11716494051807b953a75cb1815ee56936a165aed04d2337c6dd7fd062ddb6f859c8fb58c7debbcd18c44a47d614c7b864127f28de908ef3763ba667ceddd2d68ac58b242c82209adcc34c34e8d29d6c473ef3197715c657cfd491390fa052a24da17037601905f0c8c9cc23d10b55480cb3fdeab0f430dccf6cd808e944406f73ec070952c789fe8ed2a28281316afc89c38c90f9acf3570bacfe5257fe55b6b8e3f6a5f9e693581e2d83b4f68a8dcb66f055b26e7e005168fd5f2d3efc38c7961c0a289a5b6748148a8a328e9bfe3a47437e2475c37fe67617a338ee82c83793e3d7b65d508f743a5c4b3b26a63883e28b053d82cb0a84aea4871c6a3f90e81b76e2d9fab9cc72eb3e55c9bbe855384153993483b1f8f47d26747dba6204988680fac3acfb8c82998320fc2823eddb68f78cde7681569a7cca09bddc5f90475f48b57c25a3cd553702401902591f555988afa57186ace8d4d3d4affc4e372a0d2ea78a938e496934cc0b9eb5b78609fcac1f5449ca4009c5bac3c52bfee16a5e48105d8478a9595096e50aa5e5b16f954370366dab36ff60156aedc9ed726c632b6bb39782f78549279092d9218ec744d4b1719baf4d4345d1efc5bf241fca843e1051f18106c10b919877d918c0a30a82cead179c586fdd4d608a95a6951e56d972388abd1c15c37fb5d30bb264e39054be76297ed17e0b464dad6686b2e39cb8d11575d56a93107419f3697e8b9ba9b82d46a879ca7d87a1ba7dcde982e818f90e48f16d5b936710680acfa577dbac33a4b7ccdde3e1f85428ef62b8890f3872eb7d79de0c11f0bf728b87b119a66bbc5cafa6a29ff0bf8c34a840687e1d6d2d10d652fa232d9e1cc99d4d595c91beed0b52ee0ce3a1a683f5f78039623ad8dcddb07c47507ebdb77375eb594b2d9a5797db4345f70b07888128f652266bb9e6395de531083ed04491f470904cb3509f4b0fa7d6740ef2ba2facf7df51a218e940572faa57f52d29d0b19f5c5a8b6c6b8a1edda116b44cc42db068764fc585098a724304edc78677472194588959727a67189b36dbef5335735ae4ad32552779cb3960bf57715869a97b56cdc44f8919eee3e6d1ff187794b7dc5d8ed39ff9fe3a4a40367e3b4e91386041d5ea9952a975ee7a89b4ff06f9b6c5538c4d4e416b9d634b7970a93fd3bdb50858d86c0e9e2d7e154d710da03f81c6bd6b912f480c46b7042831f5aa9f50220493907bcde383c876e140c1397a9fbbfa96f9e35d08748c310d27bfb1800668a8176a40487c74d80dbcaf86f252455f5dc79e9fbed55e612a6195b3d1b33561946b89c14ee733fd4a10cd25b07d5332d29d9a0ec831799bdf9bb092161bb0a64bbb00f69746c484e3a8bfa5ee86695356558cd8d7f05dc3a88984ff29b9736f72fc77802b4c2809dd6393556aebfbeeda96fe68f6d31e888aaa43487c39931b3b58836bfbd7dc416b34a230541c9cb3763f3756f9cb75033740e457be5e6ede0075ed6a2137412a0fc8b31cd2dad6f43a8c71368e54bda342071b6ca79d3f59766b52aff675df85eb332e17b59d9ee1482ec9c47d9cd31f90c9ad1d83d22749b93d5b4742bc1d53f8688893a2e4ec4ead27df2a10bc1cd6ae4d0d5ad205d9b051102706b7115f3c939a8c651520c713abdab801fff8949188ce65e498fca75a09508b95ad481fccf7d4be5d2cc6cdde7dfb90593f985aa874ab3090a1878c405fd2c02f3aa17a0c801607cff8909b42075b9189c1bb5051b55d1ffb630bbfc27c2031d7732584492b3febfad7e72dc873aa2aa18b7fd99b21424722b1680c8202bf4d7af7cb4df593d0a9a2b68249bf74c4c88143e658eb656be865293129f4c94a811b628bd889a34d727609004d9e540bb9be62392d117824c91b8cfb0b1aa970a94daa3422e2af1b549c8cd964e918cfdabb3460af648139373ba556a70e89be37fe183e2da33bc3c5bccf7bbfda9bc3d15c56346ec64e1597639fc47fbc17d2b26e345d06796381540db2675cce00c3d38c1dae0fede210d4dc054bc602dace967d944ddfc1a2d2c9d854a995029d0f54e8f4909203fe7bfa66960206a113c7489b278f64d445058c46cf65d4ca1d61a91781ee5394073301d1f543bef00c5e5e9d16dc0f64d660637bca9af37aaf9bff73ede433b95c317e69df02f242f9116e51b8be8602ff42b2ae3a70a64e5f8a166b8b5a49355f1accf59544e2a59c515d5bd617ef918056736f7849de545da73bce37444c49e73f88a1f3cd2694bcdb2a05c88d69dfc2e1e555676fbf8515bb06bb8a694d49621c71f6a24a3a47e30050f5a37df0d75531a0a7a783f934890c9d635d29ddc6705a503ea42a8c6a1bc4d67d1658bc44991cc7e928cbc9f282f2ca350948b454aafb4989125a8ed2882f63dfb8d0ffd6b3292285de8e687161a0fc67cb049289630eea6cd47b081590f6d2b6c5f7ff25c3e48fe895e9647bee9703e48170c72c77dbd90ee8fb0936f11a6f61aa2cfe8c62689bbab8cc2b0d0c154374da2b44026b8f24d5f389918bf803daca5783e122f333cf2e4dca63d6f855a4813b9d292f4bb0a94414f27246e267b26f323b0130ee46ffb310c6eccf8decba580615d72cea8f5d48b155e5ad95f62b3e657b17a2ec29e0dcd5678e806af8fb2636f10229d49d1eebf57561fa6e15bd4641d7689db273df0cf0c46a449e1d7be71f0b16a3616a47264d91e3614ef2ed181567f05ab7c5d44f31c18dcdd652f27cae12522e61be6f4665380b22e554f2c60177433e51563573e9056537f39f06066ff36d1ad82bcf1e7e070d0e94a02fb375e3f4453029ec6455f8ce24da513bd0341dca66abe6f16b394a16bc5d210177d37c86c6bede6beaf62c9306f604252bef3c82faeb80271a3ee753170035058358ed4e5cf32571d8a0848e0c1dcfd9f2c07347dd7e2d900a6540a0854a4097a9964cdeb2dd8e78b84dfa4191c05c25d84e2d0138528f159c96a8b1a0cb879192026015b654858b2aa6137c4049f1c470e32b8aea265685710c80baaa02155999593d900d827df3a1259703a9f8c26d973fbee20727131c9faba1251b4da9c00bd52acaea006bf70d378f77fc587d5d68cc8ddce10c0269a398e02c055f85146e2bb6e0e1a756c672053dd00b2f59959bc3bae69ab6f2f00fde08b050d419cf74f081a106513d92e2f3f8375d2ad2484bf3ef72a4db088853bde735e9e0ef543b233b2c14604c6e5ab471649b16fbddb302aa847eaa839e13b67cebfafdf20b5350e7e83d8d996393e8d7d520225ad4cf89115965d246cf937159f02905701527d7e46c5cef93cf26d73b408131d738a8f00f63dde66fe3375b5140051c88c0b6ab7a7952ed89fd405717b2ea3de0401f266ba9236b3551996dbc2cd246405b43718257d833156f368e097f5469f7d68473ed8fd45860decb94b1d2d0ea7f0c74affa9a6dc97902be9090fe7d3f9b07a45c823ed207345ceca985b1c028f0a873349780570cb0685fbd0799c7023357dba140a99e9c78d65adc078888f2811a4c3afb792b4d4ac926dd37ab47f8e8c854c13d3a5a49350d463bcebe49e84f6c5bcda5fef29e5b81a3e9ca3d5ff27974320530c63fbe61ba04231c12efbbdf8db08864a58c697ee24b606d32a7387c3028d32023009de3b20bc671176488d467c6199e27ab6e52d32459606cf6676575e1ab07b8bff44504fc4695cdc549d90917065608af1c85af0ba88eb7a9cac5059f3d67c82b804ed00bcba54e6902b1a9ecfb9a44991852ba0c1b5848a75f2e3fab4ef0e47e8e304ccb1a86abd69b1c425cc0ac56d73234e6a3df75da33bc73b36f875745d46937efda7cd4f04044c7ade15d58026a8987198f5efc96853b58a7b6384a40f0e348bf7c4b84df98d6fdf6404aca6548c8244717024376b55cbe5eef4eb9f28e048f8008224462eaf010c125bb5ceb1b25359597298167df2b6a1c3256af539c88ad74bdef12cdb44e2d065db66a4a2ac3153a50fd3ed9a94f49d38b6d45f934f3f96c9c44ed8acb7e0464256c7ce3cecc82b226e54b6b119462d5b8fa4b801d40a14bbb4d087e5fa02252228284d7cc694c8d953b1b1b76ff7deb41f9cb29797b4a4b966eeea88361437dcab2f3788b6e4d6f1bde15e582f0146984995b02a91dfc63b95bcddc1d4d532f2fe184cd188d1a8cdb445d87ae88523f309b4b5cfeb06968ee7083b2af9b2953cb23334b79a2de3ac777284e4e85836bfcd20b90a206d1b16552d97abce033474819bfc97379529dbdeea8950629f51879a0b64181fb150dfe310cb49d1e338f4437de776a18feb579b5b96d3e047ac1781d630ac221edcb03ca6fbfb3eadd599e66d42c457529b9da9fa2f069a6440704ebfc4dff84dfc2659e16054010eac966c39b3c5b88a54f2800e8174b6f27ccc40cc0be6e789886fb0d8cf1cde0781884943abe5aca48a5907e56c982f6c6918a818c97cae95db5794b4b37f4e626b6267e150c6045bc99545a69569a5c60840d64468d2a6103137b0dd60089bab2a07580ab157ae41196e60681af671ad1fb325aa1c20d438abd859652a9ab4f298495f4cb3085a056d3ae950af483b480448c04b3480bf614a915b6b69d0989fc2ffca5f79eaae1be0043da314a8c6f96ff4f9846ba1862a889f914b2c8554b8d7e4c25bbe64482d5da0d552e52d4b4b7ccb6701268af7404ccea63228dfc8a11d431e47d3b7274c93d1e169602495259a35add986be7060b1700b1f57fe07e0e3bc3c263a6a11bb574c8b5e37139d04319584ff040167a56e4a6fed3eeb3ce1af5382934e48cfe0a07188f595fc6d2dfc334ed971c4307e8e29f966376b950adcb3dbc9c61906ae423d3bbdce85ccb93712ceb288da192090ccd121aa698c2cbd2401d0f33bf945e6ebf233defc5212ff52e057abd4f4b3bf89a6dd14c601f1ad171185af4187ef9e038e4b54ac5587095b4c636599e4e328d65b090a486c3459d021838faf3aced60ddf7bdd0e30aa979e86c3dca610e527e5a378950d59812003daa5b995904091263a14753780fae70d3644dd0beb8c453e2a5a18835dd91c5d15f845759c9d1bf592fd7a820401c601682919b05883bb0f1c12659a1fe6432c1b768e30c75f61550c68d02eba2790c45e531305324dec57811e8e066fd5b67fd2b4445eda16f1cc5f56bf9bd8ba86b6ae9c0d011a1ba407cd7c0fe4b88e6f754016c2e7766711ac5294b2a7f246dab4c6344e04fd418b0bea560d5a7eb509979c5bf7c6be645e9415ec67a43cd53b77717b6a846f512d981c89090410e4c13c6fdbb04711cbf1c68a849d0bd6650fdc5af6ee3273b2800e02e0ef061d7ebe6170f00c5c09f7c20660b632377a43e3ba51530b0630b74deb68007e9f17697fcdb9ca0e5aab96d871fdc1d719782e0c54499153836c40917bc9661e3fd54a4d79ce8401ff52e7875e2d62adfaedcc7fdf3760d5dc7fa1079a04d495c100641c3b60165979645acc58bff224a1f65756dd25d8adbae811270b4575f6fe1c6a66bf9ef0ee14b98d3995cbb9149d5775c0c5ffc677e709a88174179c110b90eb3bb7e722ac516fb6bdeee3aa439f4603495bf4e1b11f03906e64b44b636dc66b5f0d198d16f9955a0c8bd21a3312c6a5bb9216adee5092c6077166cda00faf81d0becf96f3257e9c847f61c52bbb4023255d7f68bddab1c4cc72806a9c8c2845f02a073706c4dd699540dcca943115f612ae19b347ae80b7bc84969f1db93247ee36f008e0d904080d93590275e3d5e53d76c3c3a5c7594333d8654491b7706d9ba90448b315e59e8cba49e5b6ee53115f2c4d60cbec6b3c470155000feeaa52626885c13947cb5ec7b7625aab8e1b6cbe2cdc579a36b3b954901f405db65b4bab144bd39d922f9f3a6db2446f777fbf301188195ff4d6ce59d84fe66877abbed7ae2ae0ad0fcdf4942478c317429d5f02cf6bab821da0ac297100b3ba2d8451f51e5d2927960e4fd2f1c911ea682717964ee070392f47ae1d7e701c5ccf8797562df0f51094acf2db82cf5230424cebf93a13334c87f4cec2ff15d1c4b5ed0966ce011d09e27d3270c750884e1055009f38808d00c220924d6eb7a9a0ef435ebce53ad8b424f08a47c5a450e9dea70f667e67c7af43889d8956726b2d92b85a691068f28a21f50c325f4f22d221fef3dbf13e99259be7d7bf177a8b471f6f4463d4a9a182d45be5d7532c25a8d9e03568a058fb166fae0e45e64bc50293375b374328db4cc24914c3ebfd16f8f2f457113e5c0318a86d8647de774e533aae1ed2067a18967dff67dc656510c3db05efca4b136476c5b7a9daa74226149d424ca688c396579600c6a8064304b5c1f1164e5d10fd26104188dcb3163bf5b5794493e282b61eca14b0146b17f9a0e895884ee7e9855d0a79e29be209e8009f9b586bd0a2ba567f1fcac6ebaa6ae745c6c34b641481fb718ead38c00211f6afc5f82ba1f2b53f036b30240d05a9a8d4e429a2a619374a1b7a9c8249f24fe1c6759e844af6a9accb6667c93c07f5d536f7df2a119062dd58819457f16c6b773e367745b0f454534f2d9c6bd55497be544e9b22f8b8509a1d4ba4b131ea59f2fcf422c96836ad133e4406b641dc72a901b2dbcfdcbcbb01633242b601e2174015768fd590d76b7cba92379ce0c98e491a05600644c91f9c1d15bc9e902962f853f1f75da252ff76bcdce06ab86196d9646950fb776901495ab0cc8a38486a891fadd0c43c3271b2979c29af18134a7f7a496ba5c07f94c35a8c3c7baee0e1c2f69888cfb069cd2b5537b3de6b47e345a93962cebbdbdbe610ee37d373ce3d9e3796a06c9d81b5e7153c1999faddeaf177a0f9b3f22228a3ac5e92785abd1762f54a124e8edbd379fccdcb2ad7c9111d1bb0295d3fa136c1f8652be3e9d4fd6a6496a7007e8b3f771e5ff4f785a9967e7fceb7e7a94759770b9611652042fc178229f0c26f526ee77f8c86c0693ff99b839b422f27a334ea01467d8993986fe609fb7db3a79fc8ce544d6df847cc474e576c2d0afe2867482834d34d148f17d1147f3987e4612947df4df598ee71381d636feebeaee62335122dd92266cb94efdc57a6de87b54844200449506ad20b2ba6322ec0a297eb6e68bbe8667a2ab57b00b2b5f21b62502437e363bde8b3f86cd0a7fc863d60efc2f74332bc59bb548ad571a4955199fc7a1c633eefd49de3221bd1d5d5f4face4067d708a63291ffb6db112df14ef49ba694fadfaabec4451f72a9ff864056ffcd8a3280509d2f1f0e4ef529e820ce1e2c9c314fe4cd2ae902fcf3a1160abd205960c69c57ea73fba74725a27dcc91926778c92ba95df0e48d1c48b5f6c253dc9dee3cf4862b0099a9fccf18617df4a31ac4eb1864961171722e51e35e3c1d2cb62fd4dee147e4c3258f7d27b8af58abf0de41db4775e868213b10d1c8d9fe74e84fe3d8508ec1b69a68a65687a879f55a36af454c11a9d759a0a7a065f1b0af08637147a69e89f0039bbe02f9235a4ec0923045e1db093ea84bfe86e4213c50832b9f77f1ae5d619f158e6b5aca1b4748dbf8aef8f85e8a340731a3a362cb70e23d3383de7eacf5ad2ddf0e5c35d3d6d67f00017abf1f786feacbbf6c19ba645072740bc629351333ccedafb93708de090d2381f4c7f0fdfca9540aa4658fd0e5c388e3f62eb8c6bbe0ea67a436ce3e250bdaf34b7b4f2c84ea371574d74e157caaf367eae77ac9fbde645c1358a078575fedcf887eaeb288bb564f37389dffbbe46c52f4557b07d285aeb09f24e4cecd582f13b588b85005aa16a029416db016d4a73bf04eaf2c0dff24c32d0e2b53e4488e7f972c93f51cc8fa947a81508ee1475d57805e37fe0d792c169e237487383603812744fa1b9cae83156fd865b2f5958c770dfaf84b1c971fe880f5079173f3aa563e9844126caec676fa088adec1fa3392ef181653df7b4a5b1e3ff45459790aa35be32fa989e1f2441bda8f85ee27fcbbfcfeae1806917500f0f0b99e9ae3caf855086580a3c13cc645c023095da8faadc5f9f5e0208d7d461eb18d0d1b29843050191e0af97ea23eaf90f3a0c1c890ce5cf05cb317b96571687b7c51c697cb2f22891e010bc00c828cf9b93f13c2e3dae19007f0da1536eb4bfbb5823ad2c8351917ccbc1153f918d0c2da69c6fdcd8a97a4fa035660c503656a928bb79d77f5bd6d3733146f917148a41cf9b2eafc5865c27acf1e7377dff342b62c9637ffd03016fced1fede57e28f775115fb29616b2e43fc98ddc0d5ab14fc3b4be33c97ea6b7345351130b9decb383a1eac34aa53927e5961c3c75dab466638f48bb5cd57721ed6f69212a24e98e7e99902f0d0aefb52221cf3d1813d314201e818d85b826a629ede6d1d70f531de79f80bb6fcf7b608d83f9f6c78e2d87281b0e4c1f5220dc8fb10605cd717ae4b7c386fb06d6b0d8adfa032660832186ddf9e3130a30a17048ace8bacc4b5121c6f24b4e70ffe4891f780550868e55e150b2661b01bf05a64914b46563ef962d062f4d4efb0d013da5491dbf8c1daca708dfd8927506934d9f4bea2e6b61f36ec518f850ca764607b7bb9c98ae3f78baf52df1771a96b43962c15e8de4f54ac2efcf32da545218cde66faabb870344bea8d091ad49a9dd5bc982437fc962e6c77a1f29e4da1a77baa618ccc3acf3aa20e435bd9c12e7c95f85063c3a7929a16f29f9f324184a89160d34238d2cd4fc0eeb1afe7d6065e4e597ee2ecd6ceb925bb0d6f9fc13cbe26144074026268f7d318732e283ef75a16ee476a7d8c118e4c2530d76d90c59d63b82e8eacd244936b3f399c2630e09dc1f87aad14eccf4ddc6ae3a70c7204fe39d04e191ff668ec8ff8efecdf8cec2d706b5cc32920162df297c1cf1e38b293199a453738e073217b1ff60aad009551c19479573fa09c531e2f13bd7272e09a1ea92b4b5c2baa8053735ddfbbdb9893456bb40d8197e74536315d448d5ca97526b88eb5dc711d7c4ed7807763bfed149795e3ae5f80ce8c5230110d7d4c03a4aec83c9b438820f2e75a854e55b13c6c0b30527d04c35b00d1139844da913a8665958110b2e8392ab01875106b9a6ca106f37d911fa390241a4f9c38848d68fc2f76481d606ef64c4f44c44f56e2a71470f7a7636f483f374e42a758ada10d0861dc98a15b37dc811210ba011dfb283ffc030d6545f13cf0340658a59d46a48a90498f2f101cf1433ef047f0addfa626d9eb02de29ca58cc44df4ba9a64eff092ece6dc71e41ef6cb8e31b83428cc2e19cb7abfd67e5aee0a948e9cc14214054e2b17eb5e5afff0163314ae7accfe4137eef66f442e250836011ae40ae4c9caf38eba73a5b45756d3c311d244c20581ba254169cbe2a68b356376532152812f2e4fc9b5c359dcef55a4f66fb8142ce93c4af79ffd7db989763d76bf9c6c4d8392b96616955d05bc2a06251645808e87cb90e7097bc04209c7a6a981a67ed1c3a9b3793bc98addd8586e5be8ed34b4fa267052b1dea7d4fcf73b888d4f7ff0aec148d770ee72d9cc0abae24d145429014a093acdd60994645be3f29b1d3b3c3e143dff35899eee79239e20fe0e27ccbe6772bd4b12b3283ca8dc53e3e9f08d04b02267223cf9828e88a4d933ccd99997640a7807a9855deac93497c2d31f92e906b98d08062e38145ea673ecfd617cc44ef275d77e8f3786d2eb0725d52636d95d092774fdb7c80bb2c736623bc338320c388ea78cfda2e08df8c6cd145b2a968ace968bd6818bac1874533145d2387231be4b2d8894261e75e47ea7fe4772724eef5d6ac3804e706ab24ee256df1f4f26f0b295a4c87498fd16bf656b621589b40870ecfa570eb31fc2115b77b07cf6f4f65036b945bac151e108e230b51a5e4eb0253b2c0c94fa582bc237ba1d4fdd020163ae1de95021acb6f6d901409f448a5b00f1e20e3e43cc52924d52df722c0492fd2b29676172ff2fa49bcccbea98ba72e224656797bcf958b3728cb0b994a1d8e7b1bbc8d8fbfa29135aa51e1342829fc8ce49240da7f958294157aeeb8d8752a9ce527472c45130f44c674da161262619b82257edf1a16b885a15f46b66da256f5d6fa211ea3b8516581db121f8b579f0ef316a073a4425681c55e45f4cdc4c26bafcc7be0d0095578a4eca45cab9789d165e85a1839467fd4fd5400ba8daf89bea13620f248ca18b5488afb29477c38010ae3a13e502b950315e271c825015ad88b60044cf99065bb8a1437f63267b503db70fc24eaa1a1bc8dc7a3da2703e3b781bdf23d02b4836711ea21db2995d9a12b91322518c9914276f9263183483251c50172f1acd86e86dc9e4fa19412c21d33f121c528c15a51b9216fea711cd8ad3a9f38bfb6ea60369b46e7ad86a411805655f1ea52d4c692e07fe68b8fbdd527aa7c6d17b31a3d4cd974cf1b307820e11eb6da3f9c3019f4abb9eff980c5d8a659fd1efe97572d2247b8ea5b3c1cec9153a995aa0e51d6125bb864017ec22314643be927090a92fd6099b06a970fab7dd2f6dd09a2df68a8318d2dfc6a00144db04cbe1bb589130b3ee2f315f6eaca2d4927b36953ac3de0e2d5b5a8cd9b03506030e7ff3c033b08bb969b2a72fe0844876f6af26e79723c200ecc50a51e826969fe6779c9f23e2afa2b66b471e191ef6ca2c1bb608f341d42c25cb2e8a9ec8d6b2045c3508f54bea71d876a63185f1539ee67efdc21f121964b9e7e9c506f4d0b9d54734f8388b06f8b7ecfe9a913b637ba9f3c3e1ab00f931bfa462d54e17b624db0e672f9677830fd6d7aa8cc2a3e19e4294652d89579349c1b4b1f9f48a78cb2b0104c6c79294dd3bbcf218cba7fcb79e4d15a8230c808677dfbd7293801d5df393908c67890ea10deaf92412440d05a82974e87ee771d4006f429362423ad6d73e1ac1434de8ffec8d123178378741069f043c0c5b8f34bb9e66548212325187cbe3be49ff7c51bd9996f6ab7e5659b73aafa70c9fa154bb3c250871af21e164f998c88784ea90fcc9abcedff27520fbfbca30cb0116ae874686665935b23e7ea8546b458fbc40ee5afc49970c9484e308082740694cf694cb162fedb33c6c813df5828aee9cd4db903eb02b30eca19b6a199808685aab2caf6f486c175c3ed1e300685efc9e5a0cc7f20d47cafd03e92d743f3e82da70b1b927b7eebe1b140325f06d809cc1299ac52fab0265a5dac406e72660ae0f6a36881fc706836e3a9f8b6333d8f1f88ab533ea709da95b2b768c188dbfbca129eaafc1622414236f9d23daeb52b42ce85e05037d2b3983846344c2e9ec7c0908fed86da95cd2f1e1a4c9395b6426a7de52ccff77a8694662119caa96d7bb9f5eba934633a34dcf380ae8981ff680b4df919457dad98b5c61f61b9d53935a10dd91734f775ce62688e647235737b6c05d801a39808fbb1967d5f7576f566372583aa4324666c8b5c539e0e702174c50798dac4bb0df7dc5731a3cf69a09f092b98b107021711a3d4108ea520c536f9e9a349e8e17830165a8bdc5be4d9eeca1cd36dfe0ff3e881a57cbc8bab621f39cb62000a5b53d299e416ab5625d55325f33d0a9adb87787c0141c1a279fcd0b880c7a709ca36a87e34ea8580f8edfe97e5b4040fbadeb39bc0a29a6855a67a6e200f74a15e3944ddcfce35bf8d56b6600353b422cbe804bca433d60b7d32eca81f520a59a003b136a4e436e4f673a10b80de7304345048e41b765f54860a46dec6cc286c1c8f1812e7e6ac8ca7fd61bab5fcb07a63bc77c77b3b2dd91ea7d61f59b493daa3a6cae55880c46f96b405bc948ecfa5e24d0b1bcf3686f55df433459bde49aa5a8a9b35e6314f5ef6e0f126ded5d41deff02239b543b096a933b503472ee485a2c93c3effc8fc656050d5f6251608e7e4a17557d1000a1f7a4dbbeeccfdf445e8caf16fd728f0456f9de5d8a24924101328dc27c99bf4c210058f561ea02003c0f36a83e85321bdc7336cd057bf0929a5fab7f9f8e807a43fc1e96a3a6bddc677e4028bc412cc5de744275df8ea36be2dd151fa697809c3f154ba89756b7722b21fd131a391d1fe750820cde5694088717f66ab8e735d409e049288a1635a8f09bff889e5cf23bf89ab74f70362c0adb4d0b51b11c5cf91d15fa5f38228a965013f643a9e975d7481bd9c0f6d0d20560888efe27fd1cea2a970ad3810411eb760f28d1e573f2af0259d5d2a5e5a70164f0d84f30461d09ec72932b8e62f9336903adca98b0a20e00ad55bb937760afabab105106d58ed4a83c6ea661a84addfabfa703c0a404430531af8323e2625aabc963b9c1d41dbe7a7bd89da73ed4dcd14550dac10ee2a1c4cd3585f7e98e8f08f382c468fb1298c32bcc0a12af2674e895809c2b47db4129280a58eff53bf2881408e9167b1dea7af70b2fb2602ca191eacd04f93beb3aebc9d5a1ce5ebfe930d791a7357b4d8ef74006df724c402170c06703d1375344df7f3fd7597a5b5dc26341750fde93c62ea3fd8af29779a0770e1f0ef14ba4c69a4b3ac65487a8681e981b48d4ef1b2d3b07cf4a92a7e72b257d5e9d7403b64b8bc4269a9f15d9681c0633ddf16f390bbe9ade6a7a648ee4ddee21a6326fa3570929d5575c91a7d68288bd500f135441342495d84e76cb5020aa6ec70f9e0ec0a8df6dafa0056a2e7fd3ef182c51aee3fdb6492c5302935ceb7942401d8126ccc6516e07c2d90ff8d2f6a6b8acc9e76769a14d66d3c1ca935797055d4adc3886b0e7f3b016c77a3f1d28e04c755c32a2f54b7177d44f68b3357e922c92b877ad8c1b0ac3dec5853b3e97994750d7a558a684bf042542d5e7204b6d1ff0c58356f1cdc9184d65d7ba4b680e774e28f2138eb30a1f3633af82615dcd55202233c44edf8e35e3a3f8cf268192340b13087a875b8527379c8b1e18a293dd9991acc609bc7a38c853b51fed04419ff43a7fd1c4139e51530f38df0a7bd3f0713c9665df756541b4510bc58ee4aaef954d5f69121f847ba5cff0f017af35bad53024302f27df3ef30c5113049c769791f1db8c8ee8457327cc72ea9df22bd359ddaab13700964bc86d31bd365e61fd9eb5c37228a23d2f213e91627357e10f8c40b88d0e3c30c61d3f5f7e96067dc192a62a6b903b3bbb299f72d447ea21ba24ef76a98f5b24a10442008498a4976995670f6351aa3aa5b26609a054beae23d73ec46a99954c0ef6756be6cd23cabc74cacf449cd98a9eb6d53d355d352d7e4a44f71adaab791874aed9115eeee7de81da7a9d07adba4c886446c31f2ae885e4c894dab0228488c6073e0a6189fc40ef3c80bf0333b96f6c17fe66866cf9adc32043b9f2e03a0889075277b1a1619792c83f7ee7447ac4de6a8cad7910ff0853676d0fb16c18912819aaba116d4484387786c522335ebd119033a9e613da5acd52b61d893b22c4cc7780a029c8b07cf7709c51d4f98a41bcc353aade03e0e1fd06e72145062f87fee03d485554b073de53abf8999a1c9aa3f2c7e3f3b0819ad59345f67c4d5da6e400f47bd89bac4cf8136679dd6cc343957b91f9eabc4a682dcb3dc8a0a316635142eb9ba5522f841acafedfc3ea7aca33fdf479c72ac154fbd0104b6d2cd6ad7ef38512d0c8b0a52bdf7c17957c5a2d9ebc20e6bcf0ae762c908de871d940808cfe113f5d6fd6502ba0fb8e57738dfd78af2c9657a5f35cee478cfc5de50cb1b45280b0c3c2e87a411ecf8a3645c2ce8cedfb183f58cdb53f859318d93896fad80851abcf357cb99ef5f0b9869aff68382991dca8887ac091eac05c254e7515653baf0c58ad13b27ac5fa511aa0cd79938032ebddeaea502ccfc0aa061055438dfccf4d3d808ad25bb4d3240cdac330338fb16a1a1d5ced0ed82e65c0699f710fb6bcd55901ff8a5892eda28140836ae106c32203af746e78f1866e27fe6f397a6a7b7b24f69c63e370ddbf45f02a1cdc1fda356a10f59680b681f10937e413686b9f1c5a364522c0d5a9fa764a3b0a9ed1628e3a9c4194fc3c8dfb6a63b1ca21c062bc1defa86c520b1d34b3dacbc4cfe51dfb065a6d7c763c7b58e8b34d8aa47120fdc3c145d2fd30fdc34c7761780f2245e8946062e04602b9a25a7a35bf10af8d4dd8c9482bab39993254440a2bb23a73b9d71db84bf1700afc4113a559cd1812c2527e89da7ec957fbcc94729ad13b87fd866a5696fb858537b535585583824835b3cd13dba73f80978fae81d7acafce34d46da278b8404e5ab46f0ffb9cbc96e50d3c76d1a69b93b2e31623c9210a43076a3ef6254a0a3c91b578c69704fc2a25809011c23715e4e80e5a9df0ae12270ca8d0945a51f11ff9a85d85fe291e798789a0f5d31cd830d92bb6aa49bfadef48124e47de20ff4ef422728710f2db1ea75a3094cc07c08658fbb31c671c7e2c61788cf0ac91147486c3daa68c7096b19b42422dfe9b9dc2baf6b7713c817e461400492dfcadb845a7cafbb5dcb692dbd82b5bbaf2332dede912f57324190dbb47db3dbbb13bb6333c1bfddb6ccc0e65832ea25e67b7222005cae0ebbdbfd66a638a8657ae8d3fd1209d107d5bb034026bff7b19ab78c85deae1be1f60cce2de27fd44408c0d4da197a8f8f27cd019b9f91ca9c604b39e74ca71d081ad80eb414f81a919e1ce1f73066bd7ebaf34067b218eb7f0f953a8fb73d996fca5a365a5fc2e82e96da9fdd1bebba13b5b14ec81af243f5def1fc2b61a41b05ed135f70c9dbf10a7f62c647d5e938faddd9ffe8819bc12ab9377df1738609cea4cebd58c7f5548dc28c414d548a8c1eec423bb125d38b58ba320c20ffde2dcd614fcb0bde0d25190303eebdb7313a0bfc92f267e22169eb3b712f0fd0ca01225a5c8ad8eb55bd0d99a17f10fb56a3c5710148d03e337033c6d452fc6db0cbfc9e0a5cf39597c2bd4799a5820d0f914bce23e5b0b2964e643ae9ccdd31b9733e91858314d756d92f2e53bb8e198aab08b5a5f08e4267a2f341e9cc340ec334a3881f310a07dc519e7b7434d4f54a1203a3e06d4fd97ae925057193664fff72c7845751cb6de1dfea6cb9abf7b5c9aa065d272b0f26381c858e04c6b6d5b41f3c23ee0269b08614dd69184b06a3bdcf961b213e84af0f51192d8a5ff4a209d514ecf388916b9c85494fd1361f8b8d0531bd91cdf7d5cfaa46addd9af875f8b464be810f486bc8f5e531bf5d2886e67cd35cae44db1fce143fe334d8606cba681ec3e8e36964252f98e21ed0dda6bf004ab69612cb9bf6c7","isRememberEnabled":false,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"4dfc800682aa3ac0879a293f789abfcc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
